<div id="LoadingBackground"></div>
<div id="MapSkeleton">
    <div class="skeleton-line" style="top: 20%; left: 10%; width: 300px; transform: rotate(-15deg);"></div>
    <div class="skeleton-line" style="top: 30%; left: 25%; width: 400px; transform: rotate(5deg);"></div>
    <div class="skeleton-line" style="top: 45%; left: 15%; width: 350px; transform: rotate(-8deg);"></div>
    <div class="skeleton-line" style="top: 55%; left: 40%; width: 450px; transform: rotate(12deg);"></div>
    <div class="skeleton-line" style="top: 65%; left: 20%; width: 280px; transform: rotate(-20deg);"></div>
    <div class="skeleton-line" style="top: 75%; left: 50%; width: 320px; transform: rotate(8deg);"></div>
    <div class="skeleton-line" style="top: 35%; left: 60%; width: 380px; transform: rotate(-12deg);"></div>
    <div class="skeleton-line" style="top: 48%; left: 70%; width: 250px; transform: rotate(18deg);"></div>

    <div class="skeleton-node" style="top: 20%; left: 15%; animation-delay: 0s;"></div>
    <div class="skeleton-node" style="top: 25%; left: 35%; animation-delay: 0.3s;"></div>
    <div class="skeleton-node" style="top: 40%; left: 22%; animation-delay: 0.6s;"></div>
    <div class="skeleton-node" style="top: 52%; left: 48%; animation-delay: 0.9s;"></div>
    <div class="skeleton-node" style="top: 68%; left: 28%; animation-delay: 1.2s;"></div>
    <div class="skeleton-node" style="top: 78%; left: 55%; animation-delay: 1.5s;"></div>
    <div class="skeleton-node" style="top: 32%; left: 68%; animation-delay: 0.4s;"></div>
    <div class="skeleton-node" style="top: 50%; left: 75%; animation-delay: 0.8s;"></div>
    <div class="skeleton-node" style="top: 45%; left: 62%; animation-delay: 1.1s;"></div>
    <div class="skeleton-node" style="top: 60%; left: 80%; animation-delay: 1.4s;"></div>
</div>
<div id="SplashScreen">
    <div id="SplashContent">
        <div id="SplashTitle">jebbe's trains</div>
        <div id="SplashSubtitle">An optimistic future for North American rail transit</div>
        <div id="MapStats"></div>
        <div id="LoadingIndicator">
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
        </div>
        <div id="LoadingText">Loading map data...</div>
        <button id="SplashButton" onclick="CloseSplash()">View Map</button>
    </div>
</div>
<div id="MapBlur"></div>
<div id="HeaderInfo"></div>
<div id="InfoPopupBackdrop" onclick="CloseInfoPopup()"></div>
<div id="InfoPopupOverlay">
    <div class="InfoPopupHeader">
        <button class="InfoPopupClose" onclick="CloseInfoPopup()">×</button>
        <div class="InfoPopupTitle" id="InfoPopupTitle"></div>
        <div class="InfoPopupSource" id="InfoPopupSource"></div>
    </div>
    <div class="InfoPopupContent" id="InfoPopupContent"></div>
</div>
<div id="BasemapSwitcher">
    <div id="LightButton" class="BasemapButton active" onclick="SwitchBasemap('Light')" title="Light Map"></div>
    <div id="DarkButton" class="BasemapButton" onclick="SwitchBasemap('Dark')" title="Dark Map"></div>
    <div id="SatelliteButton" class="BasemapButton" onclick="SwitchBasemap('Satellite')" title="Satellite"></div>
</div>
<div id="StationPopupOverlay">
    <div class="PopupHeader">
        <button class="PopupClose" onclick="CloseStationPopup()">×</button>
        <div class="PopupStationName" id="PopupStationName"></div>
        <div class="PopupStationType" id="PopupStationType"></div>
    </div>
    <div class="PopupContent" id="PopupContent"></div>
</div>
<div id="Sidebar">
    <div id="Handle" onclick="ToggleSidebar()">◀</div>
    <div style="padding: 40px 30px 10px 30px;">
        <div style="font-size: 10px; font-weight: 900; color: #475569; letter-spacing: 4px; margin-bottom: 4px;">NIMBY Rails</div>
        <div style="font-size: 28px; font-weight: 900; color: #0f172a; letter-spacing: -0.8px;">Passenger Rail Map</div>
    </div>
    <div id="LinesView" style="display: flex; flex-direction: column; flex-grow: 1; overflow: hidden;">
        <div style="padding: 20px 25px; display: flex; gap: 10px; align-items: center;">
            <input type="text" id="SearchInput" placeholder="Search transit routes..." onkeyup="FilterList()" style="flex: 1; border:none; padding:15px 20px; background:rgba(0,0,0,0.05); border-radius:18px; font-size:14px; outline:none; font-weight:500;">
            <button id="CollapseAllButton" onclick="CollapseAll()" title="Collapse All" style="width: 48px; height: 48px; border: none; background: rgba(0,0,0,0.05); border-radius: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; transition: all 0.2s; flex-shrink: 0;">⊟</button>
        </div>
        <div style="padding: 0 18px 20px 18px; overflow-y: auto; flex-grow: 1;" id="ListContainer"></div>
    </div>
</div>
<button id="ToggleButton" onclick="ToggleDataView()">View Detailed Map</button>